<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">
    <appender name="stdout" class="org.apache.log4j.ConsoleAppender">
        <param name="Target" value="System.out"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%p	%d{ISO8601}	%X{trace}	%t	%c	%m%n"/>
        </layout>
    </appender>

    <appender name="requests" class="org.apache.log4j.RollingFileAppender">
        <param name="File" value="logs/http.log"/>
        <param name="MaxFileSize" value="100MB"/>
        <param name="MaxBackupIndex" value="1"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%p	%d{ISO8601}	%X{trace}	%t	%c	%m%n"/>
        </layout>
    </appender>

    <!-- Bilr response logs -->
    <appender name="bilr_responses" class="org.apache.log4j.RollingFileAppender">
        <param name="File" value="logs/bilr.log"/>
        <param name="MaxFileSize" value="100MB"/>
        <param name="MaxBackupIndex" value="10"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="%p	%d{ISO8601}	%X{trace}	%t	%c	%m%n"/>
        </layout>
    </appender>

    <appender name="LOG_LEVEL_COUNTER" class="com.ning.jetty.log4j.LogLevelCounterAppender"/>

    <logger name="com.sun.jersey.api.container.filter" additivity="false">
        <level value="info"/>
        <appender-ref ref="requests"/>
    </logger>

    <logger name="com.ning.metrics" additivity="false">
        <level value="error"/>
        <appender-ref ref="stdout"/>
    </logger>

    <!-- Silence com.ning.http.client.generators.InputStreamBodyGenerator inputStream.markSupported() not supported. Some features will not works
         which doesn't seem to impact us -->
    <logger name="com.ning.http.client.generators.InputStreamBodyGenerator">
        <level value="error"/>
    </logger>

    <!-- Silence com.ning.http.client.providers.netty.NettyAsyncHttpProvider Number of application's worked threads is 8
         which is not that useful -->
    <logger name="com.ning.http.client.providers.netty.NettyAsyncHttpProvider">
        <level value="warn"/>
    </logger>

    <logger name="com.ning">
        <level value="info"/>
    </logger>

    <root>
        <priority value="info"/>
        <appender-ref ref="stdout"/>
        <appender-ref ref="LOG_LEVEL_COUNTER"/>
    </root>
</log4j:configuration>
